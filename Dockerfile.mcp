# Dockerfile.mcp
FROM node:22-alpine AS build

WORKDIR /app

# Install deps & build MCP server
COPY package.json tsconfig.json ./
COPY src/mcp_server ./src/mcp_server

RUN npm install && npm run build

# Runtime image
FROM node:22-alpine

WORKDIR /app

# Only copy what we need for runtime
COPY --from=build /app/package.json /app/package.json
COPY --from=build /app/node_modules /app/node_modules
COPY --from=build /app/dist /app/dist

# MCP server runs via stdio
CMD ["node", "dist/index.js"]